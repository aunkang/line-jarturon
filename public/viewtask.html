<html lang="en">
  <head>
    <meta charset="utf-8">
    
    <script src="https://d.line-scdn.net/liff/1.0/sdk.js"></script>
    
    <title>App</title>
  </head>
  <body onload="initialize()">
  
	<div class="container"></div>
	
	<div class="error"></div>
  
  
  <script> 
  
  function initialize() {
	  document.getElementsByClassName('error')[0].innerHTML = 'initial'
  	  document.getElementsByClassName('error')[0].appendChild('<br />')
    liff.init((data) => {
    	document.getElementsByClassName('error')[0].innerHTML = 'init'
    	document.getElementsByClassName('error')[0].appendChild('<br />')
	    liff.getProfile(({ userId }) => {
	    	document.getElementsByClassName('error')[0].innerHTML = userId
	    	document.getElementsByClassName('error')[0].appendChild('<br />')
    		fetch(userId)
    	})
	});
  }
  
  function fetch(userId) {
  
  
  fetch('https://line-jarturon.herokuapp.com/getTask?userId='+userId)
  .then(function(response) {
    return response.json();
  })
  .then(function(myJson) {
    for (let row of myJson) {
		let node = document.createElement("div");
		node.innerHTML = row['name']
		document.getElementsByClassName('container')[0].appendChild(node)
		document.getElementsByClassName('container')[0].appendChild('<br />')
	}
  }).catch(error => {
		document.getElementByClassNames('error')[0].innerHTML = node
		document.getElementsByClassName('error')[0].appendChild('<br />')
  });
  
  
  }
  
  
  
  </script>
  
  
  
  </body>
  
  </html>