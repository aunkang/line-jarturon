<html lang="en">
  <head>
    <meta charset="utf-8">
    
    <script src="https://d.line-scdn.net/liff/1.0/sdk.js"></script>
    
    <title>App</title>
  </head>
  <body onload="initialize()">
  
	<div class="container"></div>
	
	<div class="error"></div>
  
  
  <script> 
  
  function initialize() {
    liff.init((data) => {
	    liff.getProfile()
	    .then( ({ userId }) => {
    		fetch(userId)
    	})
	})
  }
  
  function fetch(userId) {
	  document.getElementsByClassName('error')[0].innerHTML = ''
	  document.getElementsByClassName('error')[0].innerHTML =+ 'fetch'
  fetch('https://line-jarturon.herokuapp.com/getTask?userId='+userId)
  .then((response) => {
	document.getElementsByClassName('error')[0].innerHTML =+ JSON.stringify(response)
	document.getElementsByClassName('error')[0].innerHTML =+ JSON.stringify(response.json())
    return response.json();
  }).then((myJson) => {
	document.getElementsByClassName('error')[0].innerHTML += JSON.stringify(myJson)
  	document.getElementsByClassName('error')[0].innerHTML += '<br />'
    for (let row of myJson) {
		let node = document.createElement("div");
		node.innerHTML = row['name']
		document.getElementsByClassName('container')[0].appendChild(node)
		document.getElementsByClassName('container')[0].innerHTML += '<br />'
	}
  }).catch(error => {
	    document.getElementByClassNames('error')[0].innerHTML += "error"
		document.getElementByClassNames('error')[0].innerHTML += JSON.stringify(error)
		document.getElementsByClassName('error')[0].innerHTML += '<br />'
  });
  
  
  }
  
  
  
  </script>
  
  
  
  </body>
  
  </html>